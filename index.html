<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aufgaben & Punkte - Kids Dashboard</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap');
  body {
    font-family: 'Comic Neue', cursive, sans-serif;
    background: linear-gradient(135deg, #f9f1e7 0%, #c1e1f4 100%);
    color: #333;
    margin: 0;
    padding: 0 10px 30px;
    min-height: 100vh;
  }
  header {
    text-align: center;
    padding: 15px 10px 0;
    color: #2a4d69;
    text-shadow: 1px 1px 0 #f0e9d2;
  }
  h1 {
    font-size: 2.5rem;
    margin-bottom: 0.2em;
  }
  h2 {
    color: #4b86b4;
    margin-bottom: 0.5em;
    border-bottom: 3px solid #f4d35e;
    padding-bottom: 0.3em;
  }
  button {
    background-color: #f4d35e;
    border: none;
    border-radius: 8px;
    padding: 12px 22px;
    font-weight: bold;
    font-size: 1.1rem;
    cursor: pointer;
    box-shadow: 0 4px 6px rgb(0 0 0 / 0.1);
    transition: background-color 0.3s ease;
    margin: 15px 0;
  }
  button:hover {
    background-color: #f9d976;
  }
  .container {
    max-width: 600px;
    margin: 0 auto 50px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 8px 14px rgb(0 0 0 / 0.12);
    padding: 20px 25px;
  }
  label {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    font-size: 1.1rem;
    cursor: pointer;
  }
  label input[type="checkbox"] {
    margin-right: 14px;
    width: 24px;
    height: 24px;
    cursor: pointer;
    accent-color: #f4d35e;
    transition: transform 0.15s ease;
  }
  label input[type="checkbox"]:checked {
    transform: scale(1.2);
  }
  .points {
    font-weight: bold;
    color: #f4a261;
    margin-left: auto;
    font-size: 1rem;
    user-select: none;
  }
  .task-group {
    margin-bottom: 30px;
  }
  .hidden {
    display: none;
  }
  #afternoonTasks {
    margin-top: 20px;
  }
  .weekdays {
    text-align: center;
    margin-bottom: 10px;
    color: #777;
    font-size: 0.9rem;
  }
  .weekdays span {
    margin: 0 6px;
    padding: 3px 7px;
    border-radius: 4px;
    background-color: #e0f0f8;
    color: #3572a5;
    font-weight: 600;
  }
  #pointsSummary {
    text-align: center;
    font-size: 1.4rem;
    margin-top: 15px;
    color: #2a4d69;
    font-weight: 700;
    user-select: none;
  }
  #redeemSection {
    background: #f4f4f4;
    border-radius: 12px;
    padding: 20px 15px;
    margin-top: 20px;
    box-shadow: inset 0 2px 4px rgb(0 0 0 / 0.05);
  }
  #redeemSection h3 {
    color: #f4a261;
    margin-bottom: 15px;
  }
  #redeemSection button {
    background-color: #e76f51;
    color: white;
    border-radius: 8px;
    padding: 12px 18px;
    font-weight: 700;
    font-size: 1.1rem;
    cursor: pointer;
    border: none;
    margin-top: 8px;
    box-shadow: 0 4px 6px rgb(0 0 0 / 0.1);
    transition: background-color 0.3s ease;
  }
  #redeemSection button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
    box-shadow: none;
  }
  #redeemSection button:hover:not(:disabled) {
    background-color: #d85c3b;
  }
  /* Animation */
  .task-checked {
    animation: pulse 0.4s ease forwards;
  }
  @keyframes pulse {
    0% {transform: scale(1);}
    50% {transform: scale(1.15);}
    100% {transform: scale(1);}
  }
  /* Scrollbar for mobile */
  ::-webkit-scrollbar {
    width: 8px;
  }
  ::-webkit-scrollbar-thumb {
    background: #f4d35e;
    border-radius: 8px;
  }
</style>
</head>
<body>
<header>
  <h1>Mein Aufgaben- & Punkteplan</h1>
  <p>Erledige deine Aufgaben, sammle Punkte und löse tolle Belohnungen ein!</p>
</header>

<div class="container" id="morningContainer">
  <h2>Morgen Aufgaben</h2>
  <div class="task-group" id="morningTasks">
    <label>
      <input type="checkbox" id="aufstehen" />
      Aufstehen vor 6:25 Uhr <span class="points">1 Punkt</span>
    </label>
    <label>
      <input type="checkbox" id="essen" />
      Frühstück essen <span class="points">2 Punkte</span>
    </label>
    <label>
      <input type="checkbox" id="zaehne" />
      Zähne putzen um 6:40 Uhr <span class="points">2 Punkte</span>
    </label>
    <label>
      <input type="checkbox" id="haare" />
      Haare kämmen um 6:45 Uhr <span class="points">1 Punkt</span>
    </label>
  </div>
  <button id="startAfternoonBtn">Nachmittag starten</button>
</div>

<div class="container hidden" id="afternoonContainer">
  <h2>Nachmittag Aufgaben</h2>

  <div class="weekdays" id="weekdayDisplay">Heute ist: <span id="weekdayName"></span></div>

  <div class="task-group" id="afternoonTasks">
    <label>
      <input type="checkbox" id="spielen" />
      30 Minuten alleine spielen (Mo-Fr) <span class="points">5 Punkte</span>
    </label>
    <label class="mon only">
      <input type="checkbox" id="deckentisch" />
      Tisch fürs Abendbrot decken (Mo) <span class="points">4 Punkte</span>
    </label>
    <label class="tue only">
      <input type="checkbox" id="treppeputzen" />
      Treppe putzen (Di) <span class="points">4 Punkte</span>
    </label>
    <label class="wed only">
      <input type="checkbox" id="geschirr" />
      Geschirrspüler ein-/ausräumen (Mi) <span class="points">4 Punkte</span>
    </label>
    <label>
      <input type="checkbox" id="tisch-morgens" />
      Tisch abräumen morgens (Mo-So) <span class="points">2 Punkte</span>
    </label>
    <label>
      <input type="checkbox" id="tisch-mittags" />
      Tisch abräumen mittags (Mo-So) <span class="points">2 Punkte</span>
    </label>
    <label>
      <input type="checkbox" id="tisch-abends" />
      Tisch abräumen abends (Mo-So) <span class="points">2 Punkte</span>
    </label>
  </div>
</div>

<div class="container" id="pointsContainer">
  <h2>Punkteübersicht</h2>
  <div id="pointsSummary">Gesamtpunkte: 0</div>

  <div id="redeemSection">
    <h3>Belohnungen einlösen</h3>
    <button id="redeemTabletBtn" disabled>1 Stunde Tabletzeit (20 Punkte)</button><br />
    <button id="redeemMamaBtn" disabled>1 Stunde Zeit mit Mama (10 Punkte)</button><br />
    <button id="redeemPapaBtn" disabled>1 Stunde Zeit mit Papa (10 Punkte)</button><br />
  </div>

  <button id="resetDayBtn" style="margin-top: 20px; background:#f07167; color:white;">Tag zurücksetzen</button>
</div>

<script>
(() => {
  const taskPoints = {
    aufstehen: 1,
    essen: 2,
    zaehne: 2,
    haare: 1,
    spielen: 5,
    deckentisch: 4,
    treppeputzen: 4,
    geschirr: 4,
    "tisch-morgens": 2,
    "tisch-mittags": 2,
    "tisch-abends": 2
  };

  const redeemPoints = {
    tablet: 20,
    mama: 10,
    papa: 10
  };

  // Elements
  const morningContainer = document.getElementById('morningContainer');
  const afternoonContainer = document.getElementById('afternoonContainer');
  const startAfternoonBtn = document.getElementById('startAfternoonBtn');
  const pointsSummary = document.getElementById('pointsSummary');
  const redeemTabletBtn = document.getElementById('redeemTabletBtn');
  const redeemMamaBtn = document.getElementById('redeemMamaBtn');
  const redeemPapaBtn = document.getElementById('redeemPapaBtn');
  const resetDayBtn = document.getElementById('resetDayBtn');
  const weekdayName = document.getElementById('weekdayName');

  const checkboxes = document.querySelectorAll('input[type=checkbox]');
  let points = 0;

  // Initialize weekday display
  function updateWeekdayDisplay() {
    const days = ['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'];
    const d = new Date();
    weekdayName.textContent = days[d.getDay()];
    // Show/hide tasks by weekday classes
    checkboxes.forEach(cb => {
      const label = cb.parentElement;
      label.classList.remove('hidden');
      if(label.classList.contains('mon') && d.getDay() !== 1) label.classList.add('hidden');
      if(label.classList.contains('tue') && d.getDay() !== 2) label.classList.add('hidden');
      if(label.classList.contains('wed') && d.getDay() !== 3) label.classList.add('hidden');
    });
  }

  // Load state from localStorage
  function loadState() {
    const saved = localStorage.getItem('tasksStatus');
    if(saved) {
      const obj = JSON.parse(saved);
      checkboxes.forEach(cb => {
        cb.checked = !!obj[cb.id];
      });
    }
    points = parseInt(localStorage.getItem('points')) || 0;
    updatePointsDisplay();
    updateRedeemButtons();
    updateWeekdayDisplay();

    // Show afternoon if any afternoon task checked
    if (['spielen', 'deckentisch', 'treppeputzen', 'geschirr', 'tisch-morgens', 'tisch-mittags', 'tisch-abends']
        .some(id => document.getElementById(id).checked)) {
      morningContainer.classList.add('hidden');
      afternoonContainer.classList.remove('hidden');
    }
  }

  // Save state to localStorage
  function saveState() {
    const obj = {};
    checkboxes.forEach(cb => obj[cb.id] = cb.checked);
    localStorage.setItem('tasksStatus', JSON.stringify(obj));
    localStorage.setItem('points', points);
  }

  // Calculate total points from checked tasks
  function calculatePoints() {
    let total = 0;
    checkboxes.forEach(cb => {
      if(cb.checked) {
        total += taskPoints[cb.id] || 0;
      }
    });
    points = total;
  }

  function updatePointsDisplay() {
    pointsSummary.textContent = `Gesamtpunkte: ${points}`;
  }

  function updateRedeemButtons() {
    redeemTabletBtn.disabled = points < redeemPoints.tablet;
    redeemMamaBtn.disabled = points < redeemPoints.mama;
    redeemPapaBtn.disabled = points < redeemPoints.papa;
  }

  // Check time constraints
  function checkTimeConstraints() {
    const now = new Date();
    const after625 = now.getHours() > 6 || (now.getHours() === 6 && now.getMinutes() > 25);
    const after640 = now.getHours() > 6 || (now.getHours() === 6 && now.getMinutes() > 40);
    const after645 = now.getHours() > 6 || (now.getHours() === 6 && now.getMinutes() > 45);

    // Disable Aufstehen if after 6:25 and not checked yet
    const aufstehenCb = document.getElementById('aufstehen');
    if(after625 && !aufstehenCb.checked) aufstehenCb.disabled = true;

    // Disable Zähne putzen if after 6:40 and not checked yet
    const zaehneCb = document.getElementById('zaehne');
    if(after640 && !zaehneCb.checked) zaehneCb.disabled = true;

    // Disable Haare kämmen if after 6:45 and not checked yet
    const haareCb = document.getElementById('haare');
    if(after645 && !haareCb.checked) haareCb.disabled = true;
  }

  // Animate checkbox on change
  function animateCheckbox(cb) {
    if(cb.checked) {
      cb.classList.add('task-checked');
      setTimeout(() => cb.classList.remove('task-checked'), 400);
    }
  }

  // Event listeners for checkboxes
  checkboxes.forEach(cb => {
    cb.addEventListener('change', () => {
      animateCheckbox(cb);
      checkTimeConstraints();
      calculatePoints();
      updatePointsDisplay();
      updateRedeemButtons();
      saveState();
    });
  });

  // Start afternoon tasks
  startAfternoonBtn.addEventListener('click', () => {
    morningContainer.classList.add('hidden');
    afternoonContainer.classList.remove('hidden');
    saveState();
  });

  // Redeem buttons functionality
  redeemTabletBtn.addEventListener('click', () => {
    if(points >= redeemPoints.tablet) {
      alert('Du hast 1 Stunde Tabletzeit eingelöst! Viel Spaß!');
      points -= redeemPoints.tablet;
      uncheckAllTasks();
    }
    updatePointsDisplay();
    updateRedeemButtons();
    saveState();
  });

  redeemMamaBtn.addEventListener('click', () => {
    if(points >= redeemPoints.mama) {
      alert('Du hast 1 Stunde Zeit mit Mama eingelöst! Genieße die gemeinsame Zeit!');
      points -= redeemPoints.mama;
      uncheckAllTasks();
    }
    updatePointsDisplay();
    updateRedeemButtons();
    saveState();
  });

  redeemPapaBtn.addEventListener('click', () => {
    if(points >= redeemPoints.papa) {
      alert('Du hast 1 Stunde Zeit mit Papa eingelöst! Genieße die gemeinsame Zeit!');
      points -= redeemPoints.papa;
      uncheckAllTasks();
    }
    updatePointsDisplay();
    updateRedeemButtons();
    saveState();
  });

  // Uncheck all tasks helper
  function uncheckAllTasks() {
    checkboxes.forEach(cb => {
      cb.checked = false;
    });
  }

  // Reset day button
  resetDayBtn.addEventListener('click', () => {
    if(confirm('Möchtest du wirklich alle Aufgaben zurücksetzen?')) {
      uncheckAllTasks();
      points = 0;
      updatePointsDisplay();
      updateRedeemButtons();
      morningContainer.classList.remove('hidden');
      afternoonContainer.classList.add('hidden');
      checkTimeConstraints();
      saveState();
    }
  });

  // On load
  window.addEventListener('load', () => {
    loadState();
    checkTimeConstraints();
  });

  // Auto reset daily at midnight (optional, if page stays open)
  setInterval(() => {
    const now = new Date();
    if(now.getHours() === 0 && now.getMinutes() === 0) {
      resetDayBtn.click();
    }
  }, 60*1000);

})();
</script>
</body>
</html>
